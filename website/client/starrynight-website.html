<head>
  <title>starrynight-website</title>
</head>

<body>
  <!-- first layer -->
  <img src="{{getRandomImage}}" id="backgroundImage" alt="">
  <!-- <img src="starrynight-van-gogh.jpg" id="backgroundImage" alt=""> -->
  {{> hello}}
</body>

<template name="hello">
  <div class="hidden">{{resized}}</div>

  <div id="transparentPanel" class="container" style="{{getStyle}}"></div>

  <div id="mainPanel" class="padded container helveticas" style="{{getStyle}}">
    <div id="innerPanel" class="panel panel-default">
      <h1>StarryNight</h1>
      <h4>Meteor Testing and Scaffolding Tool; v 3.2.62</h4>

      <h2>What is StarryNight?</h2>
      <hr>
      <p>
        StarryNight is a managment tool for use in building and testing <a href="http://www.meteor.com/">Meteor.js</a> applications.  It's main intent is for creating HIPAA and FDA compliant Meteor apps (but it's useful for a lot more than that).  It's a direct result of 2 years of working on the <a href="http://github.com/awatson1978/meteor-cookbook.git">Meteor Cookbook</a> and the <a href="http://clinical.meteor.com">Clinical Meteor Track</a>, and makes extensive use of <a href="http://nightwatchjs.org/">Nightwatch.js</a>.
      </p>


      <h2>Installation</h2>
      <hr>
      {{#prism language="bash"}}
          npm install starrynight -g
      {{/prism}}
      <p>
        You'll also need to install:
        <a href="https://support.apple.com/kb/DL1572?locale=en_US">Java for OSX</a>
        <a href="http://ftp.mozilla.org/pub/mozilla.org/firefox/releases/35.0/">Firefox 35</a>
      </p>
      <p>
        StarryNight now supports dynamic Npm prefixing, which means that, in theory, it should install correctly on Linux and Windows.  We've had some success with Linux, but less success with Windows.  Log a ticket if you have any problems.   Better yet, give us a shout-out if you actually *do* get it installed on environments other than Mac.  @awatson1978, forums.meteor.com, etc.
      </p>

      <h2>FDA Title 21</h2>
      <hr>
      <p>
        The U.S. Food and Drug Administration species in the <a href="http://www.accessdata.fda.gov/scripts/cdrh/cfdocs/cfcfr/CFRSearch.cfm?fr=820.75">Code of Federal Regulations Title 21, ยง 820.75</a> (hereafter referred to as 21CFR820.75) that medical devices require both <b>verification</b> and <b>validation</b> testing.  These terms comes from the field of process engineering (think Six Sigma), and are known in the software industry as <b>unit testing</b> and <b>acceptance testing</b>.  StarryNight is the culmination of two years of work towards getting Meteor apps FDA certified, and we'll use those terms extensively through this documentation and within the utility itself.  For more information, please see <a href="http://www.fda.gov/downloads/RegulatoryInformation/Guidances/ucm126955.pdf">General Principles of Software Validation; Final Guidance for Industry and FDA Staff</a>
      </p>


      <h2>System Architecture</h2>
      <hr>
      <p>
        The following system architecture is what StarryNight is being coded towards.  We're mostly complete with this entire architecture (due to the amazing work of Andrei Rusu), with only the mocha and cucumber libraries left to integrate.  We have the cucumber integration path figured out; and the the mocha integration is in the pipeline for next-month.  The goal is to eventually have an isomorphic testing framework, that uses the same testing API on client, server, and packages, and this is how we intend to implement it.
      </p>
      <img id="architectureDiagram" src="NightwatchMeteor.png" alt="" />

      <h2>Commands</h2>
      <hr>
      <div class="horizontally-padded">
        <p>
          <b>help</b><br>
          Prints out some information on commands that can be run and what arguments they take.
        </p>
        <p>
          <b>run-framework</b><br>
          Launches a specific test framework and running.  Currently officially supports <b>--nightwatch</b> and <b>tinytest-ci</b>.  For experimental support, please check the source code.
        </p>
        <p>
          <b>run-tests</b><br>
          Alias for <b>run-framework</b>.  Will eventually support <b>--verfication</b>, <b>--validation</b>, <b>--client</b>, <b>--server</b>, and <b>--all</b> flags.
        </p>
        <p>
          <b>display-env</b><br>
          Display all the environment variables for Meteor (there's approximately 60 of them).
        </p>
        <p>
          <b>audit-permissions</b><br>
          Primarily for any EACCESS errors, or if you find yourself running commands with 'sudo'.  Will modify file permissions on relevant files.
        </p>
        <p>
          <b>scaffold</b><br>
          Copies parts of the Reference Scaffold into your application.  Will overwrite existing files.  Should be run from the application root, where the .meteor directory is located.
        </p>
        <p>
          <b>clone</b><br>
          Clones a github url into the current directory.  Not very smart. Does a raw clone, with any ancillary documentation in the github repository, such as the README.md.
        </p>
        <p>
          <b>create</b><br>
          Refactors the files from a directory into a package in the /packages directory.  Must be run from the application root where the .meteor directory is located.
        </p>
        <p>
          <b>pattern</b><br>
          A 'smart-clone' which looks into a github repository for directories in the Reference Scaffold, and patches those files into your app.  Overwrites existing files.
        </p>
        <p>
          <b>rename</b><br>
          Renames directories and files according to the pattern you specify.  Is not case sensitive.  The optional directory argument will scope the rename operation within the specified subdirectory.  Run in the application parent directory to include tests in the /test directory.
        </p>
        <p>
          <b>find-and-replace</b><br>
          Basically the same as the rename command, but opens up files and replaces occurrences of the specified pattern in the code itself.
        </p>
        <p>
          <b>refactor</b><br>
          Runs both a rename and refactor command.
        </p>
        <p>
          <b>survey</b><br>
          Alias for <b>run-tests</b>.  Deprecated.  v1.x API.
        </p>
        <p>
          <b>extract-ids</b><br>
          Extracts element ids from the specified file. Best used on a Blaze/Spacebars html file.
        </p>
        <p>
          <b>extract-classes</b><br>
          Extracts element class names from the specified file. Best used on a Blaze/Spacebars html file.
        </p>
        <p>
          <b>extract-tests-for</b><br>
          Extracts ids from the specified file, and generate a Nightwatch command script.
        </p>
        <p>
          <b>generate-release-json</b><br>
          Generate a release.json file for use with `meteor publish-release` so you can publish a track.  (Advanced tool.)
        </p>
        <p>
          <b>generate-travis</b><br>
          Add a .travis.yml file to your application to get started with continuous integration.  Command assumes that you're using the Reference Scaffold, and your app is located in a /webapp directory.
        </p>
        <p>
          <b>generate-autoconfig</b><br>
          Generates the <b>.meteor/nightwatch.json</b> config file for Nightwatch to use.  Parses the application and searches for .test directories, which allows you to keep tests with their associated components.
        </p>
        <p>
          <b>compact</b><br>
          Recursively searches for <b>.meteor/local/build</b> and <b>screenshot</b> directories which it will then delete to save space on your diskdrive.  Can be run across repositories.  Use the <b>--scan</b> flag to nondestructively scan.
        </p>


        <!-- <hr>
        <p>
          <b>clean</b><br>
          Similar to meteor reset, but doesn't dump the database.  Clears the following directories: .meteor/local, .temp, .demeteorizer.
        </p>
        <p>
          <b>connect</b><br>
          There's a few services that people commonly like to connect their applications to, such as google-analytics and uservoice, which only require a single file copied into their app.      This will get those files in place without having to research things.
        </p>
        <p>
          <b>install-dev-tools</b><br>
          Installs common development tools for Meteor, including Atom.io.
        </p>
        -->
      </div>



      <h2>Generic Flags</h2>
      <hr>
      <div class="horizontally-padded">
        <p>
          <b>--root</b><br>
          StarryNight generally expects to be run from the root of an application, and most commands will default to running relative from the root of the application.  The <b>--root</b> flag will adjust where a command runs relative to.  Generally used for restricting a command to running from a subdirectory.
        </p>
        <p>
          <b>--framework</b><br>
          StarryNight supports a half-dozen testing frameworks; and defaults to an integrated version that uses parts from each.  If a command supports the <b>--framework</b> flag, it will restrict the command to only modifying files associated with that particular framework.
        </p>
        <p>
          <b>--boilerplate</b><br>
          A boilerplate is a generic application scaffold that's specific to some functionality.  A boilerplate differs from a package in that it's expected you'll use a boilerplate as a starting-off point.  It's not a self-contained piece of code.  It's more like a self-contained starting point for future code development.
        </p>
        <p>
          <b>--from</b><br>
          Many commands involve copying, moving, or renaming things from one location to another.  This flag generally accepts either a relative url path or a string, depending on context.
        </p>
        <p>
          <b>--to</b><br>
          Many commands involve copying, moving, or renaming things from one location to another.  This flag generally accepts either a relative url path or a string, depending on context.
        </p>
        <p>
          <b>--url</b><br>
          Specifies that the following URL should be used as an input to the command.
        </p>
        <p>
          <b>--mode</b><br>
          Specifies a testing mode for FDA review.
        </p>
      </div>

      <h2>Global Flags</h2>
      <hr>
      <div class="horizontally-padded">
        <p>
          <b>--debug</b><br>
          Prints out debug information.
        </p>
        <p>
          <b>--trace</b><br>
          Prints out even more detailed debugging information.
        </p>
      </div>





      <h2>Testing Quickstart</h2>
      <hr>
      <p>
        Supports package testing via TinyTest framework; and acceptance testing and unit testing via the Nightwatch testing framework.  Here's the quick-and-simple way of getting started.
      </p>
      {{#prism language="bash"}}
        # add acceptance tests to your application (using the nightwatch framework)
        $ starrynight scaffold --framework nightwatch

        # make sure the acceptance testing framework is running
        $ starrynight run-tests --framework nightwatch

        # if you have packages in your application
        $ starrynight run-tests --framework tinytest-ci
      {{/prism}}







      <h2>Testing Frameworks</h2>
      <hr>
      <p>
        Supports package testing via TinyTest framework; and acceptance testing and unit testing via the Nightwatch testing framework.  Here's the quick-and-simple way of getting started.
      </p>
      <p>
        <b>nightwatch</b><br>
        Node based library for managing Selenium servers.  Supports acceptance testing, unit testing, screenshots, tagging, and many more advanced features.
      </p>
      <p>
        <b>tinytest</b><br>
        Meteor's built in test framework for testing isopacks. Tests on both client and server.  Runs in a web-browser with user interface.
      </p>
      <p>
        <b>tinytest-ci</b><br>
        Meteor's built in test framework for testing isopacks. Tests on both client and server.  Runs in a web-browser with user interface.
      </p>
      <p>
        <b>multi</b><br>
        An experimental multi-framework option that runs both Nightwatch and TinyTest-CI.
      </p>
      <span class="gray">
        <p>
          <b>end-to-end</b><br>
          Experimental framework based on mocha which supports testing OAuth functionality.  <a href="https://github.com/meteor/e2e">Originally written by the MDG</a>, you might want to take a look at the <a href="https://github.com/awatson1978/e2e/tree/community-use">community use fork</a> for experimenting in your own apps.
        </p>
      </span>
      <!-- <span class="gray">
        <p>
          <b>spacejam</b><br>
          Package testing framework that extends TinyTest with chai assertions and a command line option.  A little inconsistent with launching, so it's remaining in experimental status for the time being.
        </p>
        <p>
          <b>mocha</b><br>
          Unit/Integration testing framework for Node.  Framework launches, but cannot find config file and/or test files, so remaining in experimental status.
        </p>
        <p>
          <b>pioneer</b><br>
          Acceptance testing framework that uses Cucumber, which itself uses Selenium with Gherkin syntax, a behavior-driven-development style.  Framework launches, but cannot find config file and/or test files, so remaining in experimental status.
        </p>
        <p>
          <b>jasmine</b><br>
          Unit/Integration testing framework for Node.  Experimental support.  Framework launches, but cannot find config file and/or test files, so remaining in experimental status.
        </p>
      </span> -->


      <h2>Examples</h2>
      <hr>
      {{> firstTutorial}}



      <h2>Testing Modes</h2>
      <hr>
        <p>
          StarryNight combines functionality from a number of testing libraries, some of which overlap.  Rather than specifying a particular test framework to use; it's often benefitial to specify which part of the architecture you want to test.  Which is what Test Modes provide.  A way to specify which part of the architecture your reviewing for FDA compliance.  Note:  these testing modes are not entirely implemented yet, and will eventually be supported by the <b>run-tests</b> command.
        </p>
        <p>
          <b>all</b><br>
          Alias for running both validation and verification tests.
        </p>
        <p>
          <b>validation</b><br>
          Also known as black-box or acceptance testing.  Alias for running both client-validation and package-validation tests.
        </p>
        <p>
          <b>verification</b><br>
          Also known as unit-testing or integration testing.  Runs client, package, and server unit tests using TinyTest, Mocha, and Nightwatch.
        </p>
        <p>
          <b>package-verification</b><br>
          Unit testing of Meteor packages using TinyTest.
        </p>
        <p>
          <b>package-validation</b><br>
          Acceptance testing of Meteor packages using an automated browser controlled by Selenium.
        </p>
        <p>
          <b>server-verification</b><br>
          Unit testing of Meteor server code using Mocha syntax.
        </p>
        <p>
          <b>client-verification</b><br>
          Unit testing of Meteor client code using Nightwatch and Chai syntax.
        </p>
        <p>
          <b>client-validation</b><br>
          Acceptance testing of Meteor client code using an automated browser controlled by Selenium.
        </p>




      <h2>Client Verification Testing</h2>
      <hr>
      <p>
        More commonly known as unit-testing, Verification Testing doesn't test the Document Object Model (DOM) that the user interacts with.  Rather, it inspects the underlying javascript functions on the client.  Client-side verification testing can also test Meteor methods on the server.  Consider an ultra-simple Meteor app that has the following code.
      </p>
      {{#prism language="javascript" class="line-numbers"}}
        if(Meteor.isClient()){
          Session.setDefault("loggedInUser", "Jane Doe")
        }
        if(Meteor.isServer()){
          Meteor.methods({
            testMethod:function(){
               return "abc";
            },
            testMethodWithInput:function(value){
               return value * 2;
            }
          });
        }
      {{/prism}}

      <p>
        Our Nightwatch script to test the above code would look something like the following:
      </p>
      {{#prism language="javascript" class="line-numbers" data-line="7, 15-20"}}
        module.exports = {
          "Check Client Session" : function (client) {

            var sessionBar = false;
            client
              .url("http://localhost:3000/list/users")
              .checkSession("loggedInUser", "Jane Doe")
              .end();
          },
          "Check Server Methods" : function (client) {

            var sessionBar = false;
            client
              .url("http://localhost:3000/list/users")
              .meteorCall("testMethod", false, function(error, result){
                client.assert.equal(result, "abc");
              })
              .meteorCall("testMethodWithInput", 3, function(error, result){
                client.assert.equal(result, 6);
              })
              .end();
          }
        };
      {{/prism}}


      <h2>Isomorphic Validation API</h2>
      <hr>
      <p>
        Support for isomorphic validation testing across client and packages is now available, as of version 0.2.61.  Support includes package refactoring tools, filsystem scanning and autogeneration of nightwatch files, and use of autogenerated config files in the test runner.
      </p>
      {{#prism language="bash"}}
        # create our meteor application
        meteor create helloworld
        cd helloworld
        mkdir client/components/foo/.tests
        nano client/components/foo/foo.html
        nano client/components/foo/foo.js
        nano client/components/foo/foo.css
        nano client/components/foo/.tests/testFoo.js

        # create a package from a component
        $ starrynight create --package myname:foo --from client/components/foo

        # scan filesystem for .tests directories and build our autoconfig
        $ starrynight generate-autoconfig

        # run nightwatch tests from packages
        $ starrynight run-tests --framework nightwatch --autogenerated

        # run nightwatch tests
        $ starrynight run-tests --framework tinytest-ci
      {{/prism}}


      <h2>Reference Scaffold</h2>
      <hr>
      <p>
        StarryNight's scaffolding and pattern commands make use of the Reference Scaffold, which is a sort of default app that StarryNight uses to structure apps.  The following files and directories are specifically referenced throughout the StarryNight application, and amount to a sort of API.
      </p>
      {{#prism language="bash"}}
        /media
        /docs
        /design
        /data
        /webapp
        /webapp/client
        /webapp/client/mainLayout.html
        /webapp/client/mainLayout.js
        /webapp/client/mainLayout.less
        /webapp/client/app/components
        /webapp/client/app/components/foo/.tests
        /webapp/client/app/components/foo/.tests/actions
        /webapp/client/app
        /webapp/client/subscriptions.js
        /webapp/server
        /webapp/server/publications.js
        /webapp/lib
        /webapp/tests
        /webapp/tests/nightwatch
        /webapp/tests/nightwatch/commands
        /webapp/tests/nightwatch/commands/actions
        /webapp/tests/nightwatch/commands/methods
        /webapp/tests/nightwatch/commands/components
        /webapp/tests/nightwatch/walkthroughs
        .travis.yml
      {{/prism}}

      <p>
        The Reference Scaffold makes quite a few opinionated assumptions about how to structure an app...  everything from how to integrate analytics to which continuous-integration environment to run.  You're welcome to ignore any part, delete components, or not run the scaffolding commands in the first place.  But if you just want to get an app up-and-running, and are willing to follow some standard conventions, StarryNight will do a whole lot of the heavy-lifting for you.  But you should know what you're getting, and that begins by looking at the default directory structure of what you would get if you ran all the scaffolding components.
      </p>




      <!-- <h2>Continous Integration</h2>
      <hr>
      <p>
        Supports out-of-the-box support for Travis.org.  Support for BrowserStack and SauceLabs is coming soon!
      </p> -->



      <h2>Contributions / Technologies</h2>
      <hr>
      <ul>
        <li>Meteor</li>
        <li>GitHub</li>
        <li>Selenium</li>
        <li>Atom</li>
        <li>Phantom JS</li>
        <li>Chrome</li>
        <li>Firefox</li>
        <li>Nightwatch</li>
        <li>Meteor Bulk Release</li>
        <li>SpaceJam</li>
        <li>Travis</li>
        <li>BrowserLab</li>
        <li>Saucelabs</li>
      </ul>


      <h2>About The Name</h2>
      <hr>
      <p>
        Why 'StarryNight'?  Basically because it started out as a launcher for the Nightwatch testing framework, which was named after a Rembrandt painting.   I was looking for a piece of art that was go along with Meteor, Atmosphere, Nightwatch, and...  StarryNight was an obvious choice.
      </p>

      <h2>History</h2>
      <hr>
      <p>
        StarryNight was originally a launcher for the Nightwatch testing framework.  Somewhere along the way it seemed like a good idea to copy test files into a user's application.  Then it seemed like a good idea to run those tests on a continuous integration server.  And if we could copy some tests files into the app, maybe it would be a good idea to be able to scaffold some application boilerplate into an app as well.  And then it just became a place to add all the tools and scripts that Meteor doesn't include by default.
      </p>


      <h2>Get the Code</h2>
      <hr>
      <p class="large">
        <a href="http://github.com/awatson1978/starrynight.git"><i class="fa fa-github"></i> http://github.com/awatson1978/starrynight</a>
      </p>


      <h2>About The Backgrounds</h2>
      <hr>
      <p>
        Backgrounds generated with <a href="https://itunes.apple.com/us/app/sky-guide-view-stars-night/id576588894?mt=8">SkyGuide</a> for iPad.  Highly recommended.  Download it today!
      </p>


    </div>
  </div>


</template>
